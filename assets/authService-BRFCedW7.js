const s="iuca-user-credentials",c=()=>typeof window<"u"&&typeof window.localStorage<"u",i=()=>{if(!c())return[];try{const t=window.localStorage.getItem(s);return t?JSON.parse(t):[]}catch{return[]}},d=t=>{c()&&window.localStorage.setItem(s,JSON.stringify(t))},l=async t=>{try{if(typeof crypto<"u"&&crypto.subtle){const n=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(o=>o.toString(16).padStart(2,"0")).join("")}}catch{}let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return`fallback-${Math.abs(e)}`},h=async(t,e,r)=>{const n=await l(r),a=i().filter(o=>o.userId!==t);a.push({userId:t,hashedPassword:n}),d(a)};export{l as h,h as p};
