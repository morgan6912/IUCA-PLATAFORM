import{u as p,r as l,m as u,R as h,j as e,C as b}from"./index-C4aqFuzc.js";import{u as j}from"./useLibraryRequests-DhHk1sIu.js";import{D as f}from"./download-lqvHWmM-.js";const y=()=>{const{user:d}=p(),{requests:a,loading:i,updateStatus:n}=j(),[o,c]=l.useState([]);l.useEffect(()=>{u().then(c)},[]);const r=l.useMemo(()=>({pending:a.filter(s=>s.status==="pending").length,approved:a.filter(s=>s.status==="approved").length,denied:a.filter(s=>s.status==="denied").length}),[a]);if(!d||d.role!==h.BIBLIOTECARIO)return null;const x=s=>o.find(t=>t.id===s);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("section",{className:"rounded-3xl border border-emerald-100 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"h-8 w-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-emerald-500",children:"Autorizaciones"}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-900",children:"Solicitudes de biblioteca"})]})]}),e.jsxs("div",{className:"flex gap-4 text-sm text-slate-500",children:[e.jsxs("span",{children:["Pendientes: ",e.jsx("strong",{className:"text-emerald-600",children:r.pending})]}),e.jsxs("span",{children:["Aprobadas: ",e.jsx("strong",{className:"text-slate-900",children:r.approved})]}),e.jsxs("span",{children:["Rechazadas: ",e.jsx("strong",{className:"text-rose-600",children:r.denied})]})]})]})}),e.jsx("section",{className:"space-y-4",children:i?e.jsx("p",{className:"text-sm text-slate-500",children:"Cargando solicitudes…"}):a.length?e.jsx("div",{className:"space-y-4",children:a.map(s=>{const t=x(s.documentId),m=s.status==="approved"?"Autorizado":s.status==="denied"?"Rechazado":"Pendiente";return e.jsxs("article",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:s.documentTitle}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s.userName," · ",new Date(s.requestedAt).toLocaleString("es-ES")]})]}),e.jsx("span",{className:`text-[11px] font-semibold uppercase tracking-[0.3em] ${s.status==="pending"?"text-amber-600":s.status==="approved"?"text-emerald-600":"text-rose-500"}`,children:m})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>n(s.id,"approved"),className:"rounded-full border border-emerald-500 px-3 py-1 text-xs font-semibold text-emerald-600 transition hover:bg-emerald-50",children:"Autorizar"}),e.jsx("button",{type:"button",onClick:()=>n(s.id,"denied"),className:"rounded-full border border-rose-500 px-3 py-1 text-xs font-semibold text-rose-600 transition hover:bg-rose-50",children:"Rechazar"})]}),t&&t.url&&t.url!=="#"&&e.jsxs("a",{href:t.url,target:"_blank",rel:"noreferrer",className:"rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-700 flex items-center gap-1 hover:bg-slate-50",children:[e.jsx(f,{className:"w-4 h-4"})," Abrir recurso"]})]}),t&&e.jsxs("p",{className:"mt-3 text-xs text-slate-500",children:["Categoría: ",t.category," · Autor: ",t.author]})]},s.id)})}):e.jsx("p",{className:"text-sm text-slate-500",children:"Aún no hay solicitudes para revisar."})})]})};export{y as default};
