import{d as E,b as S,r as a,R as r,j as e,y as T}from"./index-C4aqFuzc.js";import{p as I}from"./authService-BRFCedW7.js";const R=()=>{const{showToast:v}=E(),N=S(),[o,u]=a.useState(""),[l,m]=a.useState(""),[x,p]=a.useState(r.ESTUDIANTE),[d,i]=a.useState(""),[h,c]=a.useState(""),[b,f]=a.useState(!1),[g,n]=a.useState(""),[j,y]=a.useState("");a.useMemo(()=>!o&&!l?null:`${o.trim()||"Nuevo usuario"} · ${l.trim()||"correo pendiente"}`,[o,l]);const w=()=>{const s="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789@$%*",t=Array.from({length:12},()=>s[Math.floor(Math.random()*s.length)]).join("");i(t),c(t),y(t),n("")},C=async s=>{if(s.preventDefault(),!o.trim()||!l.trim()){n("Completa nombre y correo.");return}if(d.length<4){n("La contraseña debe tener al menos 4 caracteres.");return}if(d!==h){n("Las contraseñas no coinciden.");return}n(""),f(!0);try{const t=await T(o.trim(),l.trim(),x);await I(t.id,t.email,d),v("Usuario creado con contraseña personalizada.","success"),u(""),m(""),i(""),c(""),p(r.ESTUDIANTE),N("/admin")}catch(t){console.error(t),n("Hubo un problema al crear el usuario.")}finally{f(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Crear usuario administrativo"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Genera usuarios con contraseña definida y asignales el rol adecuado. El sistema guardará la contraseña en la base de datos local."})]})}),e.jsx("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:e.jsxs("form",{className:"space-y-4",onSubmit:C,children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Nombre completo"}),e.jsx("input",{value:o,onChange:s=>u(s.target.value),placeholder:"María Pérez",className:"mt-1 w-full rounded-2xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Correo institucional"}),e.jsx("input",{value:l,onChange:s=>m(s.target.value),placeholder:"nombre@iuca.edu.mx",className:"mt-1 w-full rounded-2xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",type:"email",required:!0})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Rol"}),e.jsxs("select",{value:x,onChange:s=>p(s.target.value),className:"mt-1 w-full rounded-2xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",children:[e.jsx("option",{value:r.ESTUDIANTE,children:"Estudiante"}),e.jsx("option",{value:r.DOCENTE,children:"Docente"}),e.jsx("option",{value:r.ADMINISTRATIVO,children:"Administrativo"}),e.jsx("option",{value:r.DIRECTIVO,children:"Directivo"}),e.jsx("option",{value:r.BIBLIOTECARIO,children:"Bibliotecario"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Contraseña"}),e.jsx("input",{type:"password",value:d,onChange:s=>i(s.target.value),placeholder:"Crea una contraseña segura",className:"mt-1 w-full rounded-2xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",required:!0}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs",children:[e.jsx("button",{type:"button",onClick:w,className:"text-emerald-600 font-semibold",children:"Generar contraseña segura"}),j&&e.jsxs("span",{className:"text-slate-500",children:["Sugerida: ",j]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500",children:"Confirmar contraseña"}),e.jsx("input",{type:"password",value:h,onChange:s=>c(s.target.value),placeholder:"Repite la contraseña",className:"mt-1 w-full rounded-2xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-emerald-500",required:!0})]}),g&&e.jsx("p",{className:"text-xs text-rose-600",children:g}),e.jsx("button",{type:"submit",disabled:b,className:"w-full rounded-2xl bg-gradient-to-r from-emerald-600 to-sky-600 px-4 py-2 text-sm font-semibold text-white shadow-lg hover:opacity-90 disabled:opacity-60",children:b?"Creando...":"Crear usuario y establecer contraseña"})]})})]})};export{R as default};
