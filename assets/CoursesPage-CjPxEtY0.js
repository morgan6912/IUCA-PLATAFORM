import{c as L,u as le,d as re,f as ie,e as l,R as F,h as ne,k as ce,l as de,j as e,U as oe}from"./index-C4aqFuzc.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],me=L("check",xe);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],M=L("circle-plus",pe);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ue=L("x",he),be=({course:t,onToggle:d,style:o,waitLabel:m})=>{const u=t.enrolled?"Inscrito":t.enrolledCount>=t.capacity?"Lleno":"Cupo disponible",N=t.enrolled?"text-emerald-600 bg-emerald-50 border-emerald-200":t.enrolledCount>=t.capacity?"text-amber-600 bg-amber-50 border-amber-200":"text-iuca-blue-600 bg-iuca-blue-50 border-iuca-blue-200";return e.jsxs("div",{style:o,className:"bg-white rounded-xl shadow-md p-6 flex flex-col justify-between opacity-0 animate-fade-in-up transition-all duration-300 ease-in-out hover:shadow-xl hover:-translate-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-xs font-semibold bg-iuca-blue-100 text-iuca-blue-700 py-1 px-2 rounded-full",children:t.code}),e.jsxs("div",{className:`flex items-center text-sm ${t.enrolledCount>=t.capacity?"text-red-500":"text-slate-500"}`,children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),t.enrolledCount,"/",t.capacity]})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 mt-2",children:t.name}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Prof. ",t.teacher]}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:t.schedule}),t.prerequisites.length>0&&e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Requisitos: ",t.prerequisites.join(", ")]})]}),e.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-semibold uppercase tracking-wide",children:[e.jsx("span",{className:`rounded-full border ${N} px-2 py-1 text-xs font-semibold`,children:u}),!t.prerequisites.length&&t.enrolledCount<t.capacity&&!t.enrolled&&e.jsx(me,{className:"w-4 h-4 text-emerald-500"})]}),e.jsx("div",{className:"mt-4",children:t.enrolled?e.jsxs("button",{onClick:()=>d(t),className:"w-full flex items-center justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 transition-transform transform hover:scale-105",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"})," Desinscribir"]}):t.enrolledCount>=t.capacity?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>d(t),className:"w-full flex items-center justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-slate-500 to-slate-600 hover:from-slate-600 hover:to-slate-700 transition-transform transform hover:scale-105",children:[e.jsx(M,{className:"w-4 h-4 mr-2"})," ",m||"Lista de espera"]}),m&&e.jsx("p",{className:"text-xs text-slate-500 text-center",children:m})]}):e.jsxs("button",{onClick:()=>d(t),className:"w-full flex items-center justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-iuca-blue-500 to-iuca-blue-600 hover:from-iuca-blue-600 hover:to-iuca-blue-700 transition-transform transform hover:scale-105",children:[e.jsx(M,{className:"w-4 h-4 mr-2"})," Inscribir"]})})]})},fe=()=>{const{user:t}=le(),{showToast:d}=re(),{courses:o,loading:m,onlyOpen:u,setOnlyOpen:N,enrollCourse:$,unenrollCourse:P,error:U,clearError:O,isOnWaitlist:v,leaveWait:_,waitPos:G,currentCredits:H,maxCredits:q}=ie(),[r,y]=l.useState("inscripcion"),[c,B]=l.useState([]),[E,V]=l.useState(null),[p,W]=l.useState(""),[w,A]=l.useState(""),[C,T]=l.useState([]),[i,k]=l.useState(null),h=(t==null?void 0:t.role)===F.ESTUDIANTE;l.useEffect(()=>{h&&(r==="calificaciones"||r==="historial")&&t&&(ne(t.id).then(B),ce(t.id).then(V))},[t,r,h]);const b=l.useCallback(()=>{if(!t||t.role!==F.ESTUDIANTE){T([]);return}de(t.id).then(T)},[t]);l.useEffect(()=>{b()},[b]);const z=o.filter(s=>s.enrolledCount<s.capacity).length,X=o.filter(s=>s.enrolledCount>=s.capacity).length,J=o.length,K=o.filter(s=>v(s.id)).length,Q=o.filter(s=>s.enrolled).length,[j,Y]=l.useState("todos"),Z=o.filter(s=>{if(w.trim()){const a=w.toLowerCase();if(!(s.name.toLowerCase().includes(a)||s.teacher.toLowerCase().includes(a)||s.code.toLowerCase().includes(a)||s.schedule.toLowerCase().includes(a)))return!1}return!(u&&s.enrolledCount>=s.capacity||j==="abiertos"&&s.enrolledCount>=s.capacity||j==="completos"&&s.enrolledCount<s.capacity||j==="inscritos"&&!s.enrolled)});if(m)return e.jsx("div",{children:"Cargando cursos..."});const D=h?"Matrícula en Línea":"Gestión de Cursos",I={total:c.length,aprovado:c.filter(s=>s.status==="Aprobado").length,reprobado:c.filter(s=>s.status==="Reprobado").length,pending:c.filter(s=>s.status==="Pendiente").length},S=s=>new Date(s).toLocaleString(),ee=s=>{const a=["Comprobante digital de inscripción","Instituto Universitario de Ciencias Ambientales",`Folio: ${s.id}`,`Fecha de generación: ${S(s.generatedAt)}`,"",`Estudiante: ${(t==null?void 0:t.name)||"---"}`,`Curso: ${s.courseCode} - ${s.courseName}`,`Docente asignado: ${s.teacher}`,`Horario: ${s.schedule}`,`Créditos: ${s.credits}`,`Estado: ${s.status.toUpperCase()}`].join(`
`),f=new Blob([a],{type:"text/plain;charset=utf-8"}),g=URL.createObjectURL(f),x=document.createElement("a");x.href=g,x.download=`comprobante_${s.courseCode}.txt`,x.click(),URL.revokeObjectURL(g)},se=async s=>{if(!t)return;if(s.enrolled){await P(s.id),d("Te desinscribiste del curso","info"),b();return}if(s.enrolledCount>=s.capacity){v(s.id)?(await _(s.id),d("Saliste de la lista de espera","info")):(await $(s.id),d("Solicitada inscripción (lista de espera si no hay cupo)","info"));return}const a=await $(s.id);a&&(d("Inscripción confirmada","success"),b(),k(a))},te=e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-end md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"IUCA · Matrícula y Gestión"}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:D}),e.jsx("p",{className:"text-sm text-slate-600 max-w-2xl",children:"Revisa tu progreso académico, encuentra nuevas materias y mantente al día con las notificaciones del campus."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-right lg:grid-cols-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Cursos disponibles"}),e.jsx("p",{className:"text-2xl font-semibold text-slate-800",children:J})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Cupos abiertos"}),e.jsx("p",{className:"text-2xl font-semibold text-iuca-green-600",children:z})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Cursos llenos"}),e.jsx("p",{className:"text-2xl font-semibold text-orange-500",children:X})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Mis cursos"}),e.jsx("p",{className:"text-2xl font-semibold text-iuca-green-600",children:Q})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Lista de espera"}),e.jsx("p",{className:"text-2xl font-semibold text-amber-500",children:K})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("input",{value:w,onChange:s=>A(s.target.value),placeholder:"Buscar materias, docentes o horarios...",className:"flex-1 min-w-[220px] rounded-full border border-slate-200 px-4 py-2 text-sm focus:border-iuca-blue-500 focus:ring-2 focus:ring-iuca-blue-200"}),e.jsx("button",{type:"button",onClick:()=>A(""),className:"px-4 py-2 rounded-full border border-slate-200 text-sm text-slate-600 hover:border-slate-400",children:"Limpiar filtros"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 text-xs font-semibold uppercase",children:[{label:"Todo",value:"todos"},{label:"Con cupo",value:"abiertos"},{label:"Llenos",value:"completos"},{label:"Mis cursos",value:"inscritos"}].map(s=>e.jsx("button",{type:"button",onClick:()=>Y(s.value),className:`rounded-full border px-3 py-1 transition ${j===s.value?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-500 hover:border-slate-300"}`,children:s.label},s.value))})]});return e.jsxs("div",{className:"space-y-6",children:[te,h&&C.length>0&&e.jsxs("section",{className:"rounded-3xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Comprobantes digitales"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Historial de matrículas confirmadas"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Descarga o consulta tus comprobantes oficiales cuando lo necesites."})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:[C.length," registro(s)"]})]}),e.jsx("div",{className:"mt-4 grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:C.slice(0,6).map(s=>e.jsxs("article",{className:"rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3 shadow-sm hover:bg-slate-100 cursor-pointer transition",onClick:()=>k(s),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:s.courseCode}),e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:s.courseName})]}),e.jsx("span",{className:"text-[11px] font-semibold text-emerald-700 bg-emerald-50 rounded-full px-2 py-1",children:s.status})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:S(s.generatedAt)}),e.jsx("p",{className:"text-xs text-slate-500",children:s.schedule})]},s.id))})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 animate-fade-in",children:D}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-600",children:["Créditos actuales: ",e.jsx("strong",{children:H})," / ",q]}),e.jsxs("label",{className:"text-sm text-slate-600 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:s=>N(s.target.checked)}),"Solo cursos con cupo"]})]})]}),h&&e.jsx("div",{className:"bg-white rounded-xl shadow-md p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("inscripcion"),className:`px-3 py-2 rounded-md text-sm ${r==="inscripcion"?"bg-iuca-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Inscripción"}),e.jsx("button",{onClick:()=>y("calificaciones"),className:`px-3 py-2 rounded-md text-sm ${r==="calificaciones"?"bg-iuca-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Calificaciones"}),e.jsx("button",{onClick:()=>y("historial"),className:`px-3 py-2 rounded-md text-sm ${r==="historial"?"bg-iuca-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Historial"})]})}),r==="inscripcion"&&e.jsx(e.Fragment,{}),r==="inscripcion"&&U&&e.jsx("div",{className:"p-3 rounded-md bg-red-50 text-red-700 border border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:U}),e.jsx("button",{onClick:O,className:"text-sm underline",children:"Cerrar"})]})}),r==="calificaciones"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Calificaciones"}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:"Resumen académico"})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:[c.length," ",c.length===1?"registro":"registros"," disponibles"]})]}),e.jsxs("div",{className:"mt-4 grid gap-3 sm:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Promedio"}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:E!==null?E:"--"}),e.jsx("p",{className:"text-xs text-slate-500",children:"GPA general"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Aprobados"}),e.jsx("p",{className:"text-3xl font-bold text-iuca-green-600",children:I.aprovado}),e.jsx("p",{className:"text-xs text-slate-500",children:"materias completadas"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Pendientes"}),e.jsx("p",{className:"text-3xl font-bold text-amber-500",children:I.pending}),e.jsx("p",{className:"text-xs text-slate-500",children:"en revisión"})]})]})]}),e.jsx("div",{className:"grid gap-4",children:c.slice(0,12).map(s=>e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-white p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:s.code}),e.jsx("p",{className:"text-sm text-slate-500",children:s.name}),e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:s.semester})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:s.grade}),e.jsx("span",{className:"text-xs uppercase tracking-[0.3em] text-slate-500",children:s.status})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:[s.credits," créditos"]}),e.jsx("span",{className:"font-semibold text-slate-700",children:"Revisar"})]})]},s.id))})]}),r==="historial"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Historial académico"}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:"Registro completo"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:p,onChange:s=>W(s.target.value),placeholder:"Filtrar por semestre (ej. 2023-2)",className:"w-[220px] rounded-full border border-slate-200 px-4 py-2 text-sm focus:border-iuca-blue-500 focus:ring-2 focus:ring-iuca-blue-200"}),e.jsx("button",{className:"rounded-full bg-iuca-green-600 px-4 py-2 text-sm font-semibold text-white hover:bg-iuca-green-700 transition",onClick:()=>{const s=["Código","Asignatura","Semestre","Créditos","Nota","Estado"],a=c.filter(n=>!p||n.semester.includes(p)).map(n=>[n.code,n.name,n.semester,String(n.credits),String(n.grade),n.status]),f=[s,...a].map(n=>n.map(ae=>'"'+String(ae).replace('"','""')+'"').join(",")).join(`
`),g=new Blob([f],{type:"text/csv;charset=utf-8"}),x=URL.createObjectURL(g),R=document.createElement("a");R.href=x,R.download="historial_academico.csv",R.click(),URL.revokeObjectURL(x)},children:"Exportar CSV"})]})]})}),e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:c.filter(s=>!p||s.semester.includes(p)).map(s=>e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-slate-100 bg-gradient-to-br from-white to-slate-50 p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:s.semester}),e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:s.code}),e.jsx("p",{className:"text-sm text-slate-500",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:s.grade}),e.jsx("span",{className:"text-xs uppercase tracking-[0.3em] text-slate-500",children:s.status})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:[s.credits," créditos"]}),e.jsx("span",{className:"font-semibold text-slate-700 group-hover:text-iuca-blue-600",children:"Ver detalle"})]})]},s.id))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Z.map((s,a)=>e.jsx(be,{course:s,onToggle:se,waitLabel:s.enrolledCount>=s.capacity?v(s.id)?`En lista de espera (#${G(s.id)}) - salir`:"Unirse a lista de espera":void 0,style:{animationDelay:`${a*50}ms`}},s.id))}),i&&e.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/70 px-4",children:e.jsxs("div",{className:"w-full max-w-3xl rounded-2xl bg-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Comprobante de inscripción"}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-800",children:[i.courseCode," · ",i.courseName]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ee(i),className:"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold text-slate-600 hover:bg-slate-50",children:"Descargar"}),e.jsx("button",{onClick:()=>k(null),className:"rounded-full bg-slate-900 px-3 py-2 text-xs font-semibold text-white hover:bg-slate-700",children:"Cerrar"})]})]}),e.jsxs("div",{className:"px-6 py-4 space-y-3 text-sm text-slate-600",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Folio"}),e.jsx("p",{className:"text-base font-semibold text-slate-800",children:i.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Generado"}),e.jsx("p",{className:"text-base font-semibold text-slate-800",children:S(i.generatedAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Docente"}),e.jsx("p",{className:"text-base font-semibold text-slate-800",children:i.teacher})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Créditos"}),e.jsx("p",{className:"text-base font-semibold text-slate-800",children:i.credits})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Horario"}),e.jsx("p",{className:"font-semibold text-slate-800",children:i.schedule})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-emerald-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-emerald-700",children:"Estado"}),e.jsx("p",{className:"font-semibold text-emerald-800",children:i.status.toUpperCase()}),e.jsx("p",{className:"text-xs text-emerald-700 mt-1",children:"Guarda este comprobante para cualquier aclaración o trámite académico."})]})]})]})})]})};export{fe as default};
