import{a5 as S}from"./index-C4aqFuzc.js";import{h as m}from"./authService-BRFCedW7.js";const i="http://localhost:4000",d="iuca-users",l="iuca-user-credentials",y="password",u=async(t,e=200)=>new Promise(r=>setTimeout(()=>r(t),e)),o=()=>typeof window<"u"&&typeof window.localStorage<"u",g=()=>{if(!o())return[];try{const t=window.localStorage.getItem(d);return t?JSON.parse(t):[]}catch{return[]}},w=t=>{o()&&window.localStorage.setItem(d,JSON.stringify(t))},p=()=>{if(!o())return[];try{const t=window.localStorage.getItem(l);return t?JSON.parse(t):[]}catch{return[]}},E=t=>{o()&&window.localStorage.setItem(l,JSON.stringify(t))},f=()=>{const t=g();if(t.length)return t;const e=S.map(r=>({...r}));return w(e),e};let a=null;const U=()=>(a||(a=m(y)),a),c=async t=>{const e=p(),r=t.filter(n=>!e.some(h=>h.userId===n.id));if(!r.length)return;const s=await U();E([...e,...r.map(n=>({userId:n.id,hashedPassword:s}))])},O=async()=>{try{const e=await fetch(`${i}/users`,{credentials:"include"});if(!e.ok)throw new Error("Error remoto");const r=await e.json();return await c(r),r}catch{}const t=f();return await c(t),u([...t])},D=async t=>{try{const s=await fetch(`${i}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!s.ok)throw new Error("Error remoto");return await s.json()}catch{}const e=f(),r=[t,...e.filter(s=>s.id!==t.id)];return w(r),u(t)};export{D as c,O as l};
